# 메인 도메인 - Playground
localhost {
	# API 요청은 백엔드로
	handle_path /api/* {
		reverse_proxy playground_backend:8000
	}
	
	# WebSocket 요청은 백엔드로
	handle_path /ws/* {
		reverse_proxy playground_backend:8010
	}
	
	# 나머지는 프론트엔드로
	reverse_proxy playground_frontend:3000
}

# MoodBite 서브도메인
moodbite.localhost {
	tls internal
	
	# API 요청은 백엔드로
	handle_path /api/* {
		reverse_proxy moodbite_backend:8082
	}
	
	# WebSocket 요청은 백엔드로  
	handle_path /ws/* {
		reverse_proxy moodbite_backend:8084
	}
	
	# 나머지는 프론트엔드로
	reverse_proxy moodbite_frontend:3000
}

# Trend 서브도메인  
trend.localhost {
	tls internal
	
	# API 요청은 백엔드로
	handle_path /api/* {
		reverse_proxy trend_backend:8002
	}
	
	# WebSocket 요청은 백엔드로
	handle_path /ws/* {
		reverse_proxy trend_backend:8012
	}
	
	# 나머지는 프론트엔드로
	reverse_proxy trend_frontend:3002
}

# Blog 서브도메인
blog.localhost {
	tls internal
	
	# API 요청은 백엔드로
	handle_path /api/* {
		reverse_proxy blog_backend:8003
	}
	
	# WebSocket 요청은 백엔드로
	handle_path /ws/* {
		reverse_proxy blog_backend:8013
	}
	
	# 나머지는 프론트엔드로
	reverse_proxy blog_frontend:3003
}

# 프로덕션 환경 (실제 도메인으로 배포 시 사용)
# {$BASE_DOMAIN} {
# 	reverse_proxy playground_frontend:3000
# }
#
# moodbite.{$BASE_DOMAIN} {
# 	reverse_proxy moodbite_frontend:3000
# }
#
# trend.{$BASE_DOMAIN} {
# 	reverse_proxy trend_frontend:3000
# }
#
# blog.{$BASE_DOMAIN} {
# 	reverse_proxy blog_frontend:3003
# }
